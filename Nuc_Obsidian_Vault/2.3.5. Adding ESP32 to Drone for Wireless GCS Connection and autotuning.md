
# Why do I do this?

1. AUTOTUNING OF RATE CONTROLLERS (I THINK)
2. Help with general in air stability
3. Might help with manual takeoff and landing
4. Might help with takeoff and landing modes
5. CHECK WHAT ELSE........


# 1. Uploading the DroneBridge Code and Configuring

6. Read up on [Dronebridge Installation](https://dronebridge.gitbook.io/docs/dronebridge-for-esp32/installation) page
7. Use the [Official Installation Tool](https://dronebridge.github.io/ESP32/install.html) 
8. If it says that ESP32 cant be detected or similar, try recommendations given, else try and disable and enable the driver for it in your PCs device manager
9. After Uploading, powercycle the esp32
10. Follow [Dronebridge Configuration](https://dronebridge.gitbook.io/docs/dronebridge-for-esp32/configuration) page
	1. Basically connect to `DroneBridge for ESP32` with password `dronebridge`
	2. Open following link: http://dronebridge.local
	3. Set the Mode to `WiFi Access Point Mode` and define an SSID and password for the access point
	4. Save and restart ESP32


# 2.  Wiring and QGC configuration:

11. PX4 has an [ESP32 Wifi Module](https://docs.px4.io/main/en/telemetry/esp32_wifi_module.html) page, follow this
12. Connect Wires according to following diagram, make sure where TX  and RX are on the ESP32. Also make sure ESP32 takes 5V power input and MAKE SURE OF FC PLUG ORIENTATION
13. NBNBNB!!!!!!!! This setup did not work for me. I assume the Pixhawk 6c mini can provide enought power/current to the ESP32. The ESP therefore has to be powered by an external 5V source. I used [this ESP32 from Microrobotics](https://www.robotics.org.za/ESP32-S3-N16R8?search=esp32-s) 
	1. MORE ON THIS:  When powering through the pin from the pixhawk or onboard 5V regulator and when powering through USB-C from onboard 5V regulator, it didnt work. When opening QGC, it tries to establish a handshake and then says "Communication Lost"
	2. The way I got it to work was by powering it through USB-C from my pc or powerbank.
	3. Finally, it also worked to power it through the VIM4

![[Pasted image 20250203151742.png]]

14. I plugged connector into TELEM1, as TELEM2 is already used for connection to OBC
15. In QGC Set the following parameters:
	1. MAV_0_CONFIG = `TELEM 1`
	2. MAV_0_MODE = `Normal`
	3. MAV_0_RATE= `24000` Bytes/s
	4. MAV_0_FORWARD = `Enable`
	5. SER_TEL1_BAUD = `115200 8N1`



# Why some power supplies worked and some didn't could be because of the following, check up on these:


The behavior you observed is a classic sign of a power delivery issue. When the ESP32‑C3 is drawing current—especially during Wi‑Fi transmission—it needs a stable, clean 5 V supply with enough current capacity. Here’s why the different power sources made a difference:
### The Problem with the Non‑Working Supplies

1. **VIN from Flight Controller**
    
    - **Limited Current and Regulation:**  
        The VIN output on a flight controller is often designed for low‐power peripherals and may not be able to handle the transient current spikes drawn by the ESP32‑C3 (especially during Wi‑Fi activity). It may also be subject to voltage drops under load.
    - **Noise and Interference:**  
        Flight controllers are busy devices with many components, and their power lines might carry electrical noise that can interfere with the ESP32‑C3.
2. **VIN or USB‑C from a 5 V Regulator**
    
    - **Insufficient Current Headroom:**  
        Many bench or onboard 5 V regulators used in these setups are optimized for low‐power devices. They might not be rated for the burst currents that the ESP32‑C3 requires when its radio is active.
    - **Voltage Instability:**  
        Even if the regulator is nominally 5 V, under load its output might dip below the necessary threshold. A slight drop in voltage can cause the ESP32‑C3 to reset or behave erratically.
    - **Lack of Decoupling:**  
        Regulators used in these configurations may lack the additional filtering or bulk capacitance needed to smooth out the current spikes, leading to instability.

### Why the Working Supplies Succeeded

1. **USB‑C from the Khadas Vim4, PC, or Power Bank**
    - **Robust, Regulated 5 V:**  
        These sources are designed to supply USB devices, so they deliver a stable 5 V with plenty of current headroom.
    - **Low Output Impedance:**  
        They can better handle the inrush current when the ESP32‑C3’s Wi‑Fi radio turns on, without significant voltage sag.
    - **Built‑In Protection and Filtering:**  
        Devices like PC USB ports and power banks have proper power management and filtering that smooth out any transient demands, ensuring the ESP32‑C3 sees a clean power supply.

### In Summary

- **Non‑Working Supplies:** The flight controller’s VIN and the small 5 V regulator couldn’t provide a stable, high‑current 5 V output. Under the burst current demands of Wi‑Fi, the voltage would sag or become noisy, causing the ESP32‑C3 to lose power stability and disconnect.
- **Working Supplies:** USB‑C power from the Khadas Vim4, PC, or a power bank provided a well‑regulated, low‑impedance 5 V supply with enough current headroom to handle the ESP32‑C3’s dynamic load. This prevented voltage dips and allowed DroneBridge to operate reliably.

Understanding these differences can help ensure you choose a power source that meets the current and stability requirements of your wireless flight control setup.
